!function(a){function b(){b.done||(b.done=!0,K=!0,G=!1,H.each(T,function(a){a._dom_loaded()}))}function c(){try{l.documentElement.doScroll("left")}catch(a){return void setTimeout(c,1)}b()}var d=Array.prototype,e=Function.prototype,f=Object.prototype,g=d.slice,h=f.toString,i=f.hasOwnProperty,j=window.console,k=window.navigator,l=window.document,m=k.userAgent,n="alifenxi",o="__cns",p="__cnso",q="__cna",r="__cnap",s="$set",t="$set_once",u="$add",v="$append",w="$people_distinct_id",x="__alias",y="__cmpns",z=[o,p,q,r,w,x,y],A="https:"==l.location.protocol?"https://":"http://",B="a.cnzz.com",C="",D=null,E=a&&a.__SV||0,F=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,G=!F&&-1==m.indexOf("MSIE")&&-1==m.indexOf("Mozilla"),H={},I=!1,J={api_host:A+B,heartbeat_host:A+C,cross_subdomain_cookie:!0,cookie_name:"",loaded:function(){},save_initial:!0,test:!1,verbose:!1,img:!1,track_pageview:!1,debug:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,secure_cookie:!1,store_google:!0,ip:!0,same_domain_host:[],session_timeout:1800,heartbeat:!1,heartbeat_interval:3600,heartbeat_last_day:3,web_lang:["zh","en"]},K=!1;!function(){var a=e.bind,b=d.forEach,c=d.indexOf,f=Array.isArray,j={};H.bind=function(b,c){var d,e;if(a&&b.bind===a)return a.apply(b,g.call(arguments,1));if(!H.isFunction(b))throw new TypeError;return d=g.call(arguments,2),e=function(){if(!(this instanceof e))return b.apply(c,d.concat(g.call(arguments)));ctor.prototype=b.prototype;var a=new ctor;ctor.prototype=null;var f=b.apply(a,d.concat(g.call(arguments)));return Object(f)===f?f:a}},H.bind_instance_methods=function(a){for(var b in a)"function"==typeof a[b]&&(a[b]=H.bind(a[b],a))};var k=H.each=function(a,c,d){if(null!=a)if(b&&a.forEach===b)a.forEach(c,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(e in a&&c.call(d,a[e],e,a)===j)return}else for(var g in a)if(i.call(a,g)&&c.call(d,a[g],g,a)===j)return};H.escapeHTML=function(a){var b=a;return b&&H.isString(b)&&(b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),b},H.extend=function(a){return k(g.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},H.isArray=f||function(a){return"[object Array]"===h.call(a)},H.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return!1}},H.isArguments=function(a){return!(!a||!i.call(a,"callee"))},H.toArray=function(a){return a?a.toArray?a.toArray():H.isArray(a)?g.call(a):H.isArguments(a)?g.call(a):H.values(a):[]},H.values=function(a){var b=[];return null==a?b:(k(a,function(a){b[b.length]=a}),b)},H.identity=function(a){return a},H.include=function(a,b){var d=!1;return null==a?d:c&&a.indexOf===c?-1!=a.indexOf(b):(k(a,function(a){return d||(d=a===b)?j:void 0}),d)},H.includes=function(a,b){return-1!==a.indexOf(b)}}(),H.inherit=function(a,b){return a.prototype=new b,a.prototype.constructor=a,a.superclass=b.prototype,a},H.isObject=function(a){return a===Object(a)&&!H.isArray(a)},H.isEmptyObject=function(a){if(H.isObject(a)){for(var b in a)if(i.call(a,b))return!1;return!0}return!1},H.isUndefined=function(a){return void 0===a},H.isString=function(a){return"[object String]"==h.call(a)},H.isDate=function(a){return"[object Date]"==h.call(a)},H.isNumber=function(a){return"[object Number]"==h.call(a)},H.encodeDates=function(a){return H.each(a,function(b,c){H.isDate(b)?a[c]=H.formatDate(b):H.isObject(b)&&(a[c]=H.encodeDates(b))}),a},H.formatDate=function(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())},H.safewrap=function(a){return function(){try{a.apply(this,arguments)}catch(b){L.critical("Implementation error. Please contact support@cnzz.com.")}}},H.safewrap_class=function(a,b){for(var c=0;c<b.length;c++)a.prototype[b[c]]=H.safewrap(a.prototype[b[c]])},H.strip_empty_properties=function(a){var b={};return H.each(a,function(a,c){H.isString(a)&&a.length>0&&(b[c]=a)}),b},H.truncate=function(a,b){var c;return"string"==typeof a?c=a.slice(0,b):H.isArray(a)?(c=[],H.each(a,function(a){c.push(H.truncate(a,b))})):H.isObject(a)?"[object HTMLLIElement]"==h.call(a)?c=a.innerHTML.slice(0,b):(c={},H.each(a,function(a,d){c[d]=H.truncate(a,b)})):c=a,c},H.JSONEncode=function(){return function(a){var b=a,c=function(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.lastIndex=0,b.test(a)?'"'+a.replace(b,function(a){var b=c[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},d=function(a,b){var e="",f="    ",g=0,j="",k="",l=0,m=e,n=[],o=b[a];switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(a)),typeof o){case"string":return c(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(e+=f,n=[],"[object Array]"===h.apply(o)){for(l=o.length,g=0;l>g;g+=1)n[g]=d(g,o)||"null";return k=0===n.length?"[]":e?"[\n"+e+n.join(",\n"+e)+"\n"+m+"]":"["+n.join(",")+"]",e=m,k}for(j in o)i.call(o,j)&&(k=d(j,o),k&&n.push(c(j)+(e?": ":":")+k));return k=0===n.length?"{}":e?"{"+n.join(",")+m+"}":"{"+n.join(",")+"}",e=m,k}};return d("",{"":b})}}(),H.JSONDecode=function(){var a,b,c,d,e={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},f=function(b){throw{name:"SyntaxError",message:b,at:a,text:c}},g=function(d){return d&&d!==b&&f("Expected '"+d+"' instead of '"+b+"'"),b=c.charAt(a),a+=1,b},h=function(){var a,c="";for("-"===b&&(c="-",g("-"));b>="0"&&"9">=b;)c+=b,g();if("."===b)for(c+=".";g()&&b>="0"&&"9">=b;)c+=b;if("e"===b||"E"===b)for(c+=b,g(),("-"===b||"+"===b)&&(c+=b,g());b>="0"&&"9">=b;)c+=b,g();return a=+c,isFinite(a)?a:void f("Bad number")},i=function(){var a,c,d,h="";if('"'===b)for(;g();){if('"'===b)return g(),h;if("\\"===b)if(g(),"u"===b){for(d=0,c=0;4>c&&(a=parseInt(g(),16),isFinite(a));c+=1)d=16*d+a;h+=String.fromCharCode(d)}else{if("string"!=typeof e[b])break;h+=e[b]}else h+=b}f("Bad string")},j=function(){for(;b&&" ">=b;)g()},k=function(){switch(b){case"t":return g("t"),g("r"),g("u"),g("e"),!0;case"f":return g("f"),g("a"),g("l"),g("s"),g("e"),!1;case"n":return g("n"),g("u"),g("l"),g("l"),null}f("Unexpected '"+b+"'")},l=function(){var a=[];if("["===b){if(g("["),j(),"]"===b)return g("]"),a;for(;b;){if(a.push(d()),j(),"]"===b)return g("]"),a;g(","),j()}}f("Bad array")},m=function(){var a,c={};if("{"===b){if(g("{"),j(),"}"===b)return g("}"),c;for(;b;){if(a=i(),j(),g(":"),Object.hasOwnProperty.call(c,a)&&f('Duplicate key "'+a+'"'),c[a]=d(),j(),"}"===b)return g("}"),c;g(","),j()}}f("Bad object")};return d=function(){switch(j(),b){case"{":return m();case"[":return l();case'"':return i();case"-":return h();default:return b>="0"&&"9">=b?h():k()}},function(e){var g;return c=e,a=0,b=" ",g=d(),j(),b&&f("Syntax error"),g}}(),H.base64Encode=function(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;a=H.utf8Encode(a);do b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h);while(k<a.length);switch(m=n.join(""),a.length%3){case 1:m=m.slice(0,-2)+"==";break;case 2:m=m.slice(0,-1)+"="}return m},H.utf8Encode=function(a){a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var b,c,d,e="",f=0;for(b=c=0,f=a.length,d=0;f>d;d++){var g=a.charCodeAt(d),h=null;128>g?c++:h=g>127&&2048>g?String.fromCharCode(g>>6|192,63&g|128):String.fromCharCode(g>>12|224,g>>6&63|128,63&g|128),null!==h&&(c>b&&(e+=a.substring(b,c)),e+=h,b=c=d+1)}return c>b&&(e+=a.substring(b,a.length)),e},H.UUID=function(){var a=function(){for(var a=1*new Date,b=0;a==1*new Date;)b++;return a.toString(16)+b.toString(16)},b=function(){return Math.random().toString(16).replace(".","")},c=function(a){function b(a,b){var c,d=0;for(c=0;c<b.length;c++)d|=f[c]<<8*c;return a^d}var c,d,e=m,f=[],g=0;for(c=0;c<e.length;c++)d=e.charCodeAt(c),f.unshift(255&d),f.length>=4&&(g=b(g,f),f=[]);return f.length>0&&(g=b(g,f)),g.toString(16)};return function(){var d=(screen.height*screen.width).toString(16);return a()+"-"+b()+"-"+c()+"-"+d+"-"+a()}}(),H.isBlockedUA=function(a){return/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(a)?!0:!1},H.HTTPBuildQuery=function(a,b){var c,d,e=[];return"undefined"==typeof b&&(b="&"),H.each(a,function(a,b){c=encodeURIComponent(a.toString()),d=encodeURIComponent(b),e[e.length]=d+"="+c}),e.join(b)},H.getQueryParam=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+b+"=([^&#]*)",d=new RegExp(c),e=d.exec(a);return null===e||e&&"string"!=typeof e[1]&&e[1].length?"":decodeURIComponent(e[1]).replace(/\+/g," ")},H.cookie={get:function(a){for(var b=a+"=",c=l.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null},parse:function(a){var b;try{b=H.JSONDecode(H.cookie.get(a))||{}}catch(c){}return b},set:function(a,b,c,d,e){var f="",g="",h="";if(d){var i=l.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),j=i?i[0]:"";f=j?"; domain=."+j:""}if(c){var k=new Date;k.setTime(k.getTime()+24*c*60*60*1e3),g="; expires="+k.toGMTString()}e&&(h="; secure"),l.cookie=a+"="+encodeURIComponent(b)+g+"; path=/"+f+h},remove:function(a,b){H.cookie.set(a,"",-1,b)}},H.register_event=function(){function a(a,c,d){var e=function(e){if(e=e||b(window.event),!e)return void 0;var f,g,h=!0;return H.isFunction(d)&&(f=d(e)),g=c.call(a,e),(!1===f||!1===g)&&(h=!1),h};return e}function b(a){return a&&(a.preventDefault=b.preventDefault,a.stopPropagation=b.stopPropagation),a}var c=function(b,c,d,e){if(!b)return void L.error("No valid element provided to register_event");if(b.addEventListener&&!e)b.addEventListener(c,d,!1);else{var f="on"+c,g=b[f];b[f]=a(b,d,g)}};return b.preventDefault=function(){this.returnValue=!1},b.stopPropagation=function(){this.cancelBubble=!0},c}(),H.dom_query=function(){function a(a){return a.all?a.all:a.getElementsByTagName("*")}function b(a,b){var c=" "+b+" ";return(" "+a.className+" ").replace(d," ").indexOf(c)>=0}function c(c){if(!l.getElementsByTagName)return new Array;for(var d,e=c.split(" "),f=new Array(l),g=0;g<e.length;g++)if(d=e[g].replace(/^\s+/,"").replace(/\s+$/,""),d.indexOf("#")>-1){var h=d.split("#"),i=h[0],j=h[1],k=l.getElementById(j);if(!k||i&&k.nodeName.toLowerCase()!=i)return new Array;f=new Array(k)}else if(d.indexOf(".")>-1){var h=d.split("."),i=h[0],m=h[1];i||(i="*");for(var n=new Array,o=0,p=0;p<f.length;p++){var q;q="*"==i?a(f[p]):f[p].getElementsByTagName(i);for(var r=0;r<q.length;r++)n[o++]=q[r]}f=new Array;for(var s=0,t=0;t<n.length;t++)n[t].className&&H.isString(n[t].className)&&b(n[t],m)&&(f[s++]=n[t])}else if(d.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var i=RegExp.$1,u=RegExp.$2,v=RegExp.$3,w=RegExp.$4;i||(i="*");for(var n=new Array,o=0,p=0;p<f.length;p++){var q;q="*"==i?a(f[p]):f[p].getElementsByTagName(i);for(var r=0;r<q.length;r++)n[o++]=q[r]}f=new Array;var x,s=0;switch(v){case"=":x=function(a){return a.getAttribute(u)==w};break;case"~":x=function(a){return a.getAttribute(u).match(new RegExp("\\b"+w+"\\b"))};break;case"|":x=function(a){return a.getAttribute(u).match(new RegExp("^"+w+"-?"))};break;case"^":x=function(a){return 0==a.getAttribute(u).indexOf(w)};break;case"$":x=function(a){return a.getAttribute(u).lastIndexOf(w)==a.getAttribute(u).length-w.length};break;case"*":x=function(a){return a.getAttribute(u).indexOf(w)>-1};break;default:x=function(a){return a.getAttribute(u)}}f=new Array,s=0;for(var t=0;t<n.length;t++)x(n[t])&&(f[s++]=n[t])}else{i=d;for(var n=new Array,o=0,p=0;p<f.length;p++)for(var q=f[p].getElementsByTagName(i),r=0;r<q.length;r++)n[o++]=q[r];f=n}return f}var d=/[\t\r\n]/g;return c}(),H.info={campaignParams:function(){var a="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),b="",c={};return H.each(a,function(a){b=H.getQueryParam(l.URL,a),b.length&&(c[a]=b)}),c},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(a){var b=H.info.searchEngine(a),c="yahoo"!=b?"q":"p",d={};if(null!==b){d.$search_engine=b;var e=H.getQueryParam(a,c);e.length&&(d.cn_keyword=e)}return d},browser:function(a,b,c){var b=b||"";return c?H.includes(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":H.includes(a,"FBIOS")?"Facebook Mobile":H.includes(a,"Chrome")?"Chrome":H.includes(a,"CriOS")?"Chrome iOS":H.includes(b,"Apple")?H.includes(a,"Mobile")?"Mobile Safari":"Safari":H.includes(a,"Android")?"Android Mobile":H.includes(a,"Konqueror")?"Konqueror":H.includes(a,"Firefox")?"Firefox":H.includes(a,"MSIE")||H.includes(a,"Trident/")?"Internet Explorer":H.includes(a,"Gecko")?"Mozilla":""},os:function(){var a=m;return/Windows/i.test(a)?/Phone/.test(a)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(a)?"iOS":/Android/.test(a)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Mac/i.test(a)?"Mac OS X":/Linux/.test(a)?"Linux":""},device:function(a){return/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Windows Phone/i.test(a)?"Windows Phone":/Android/.test(a)?"Android":""},referringDomain:function(a){var b=a.split("/");return b.length>=3?b[2]:""},properties:function(){return H.extend({ali_lib:"web",$referrer:l.referrer||"$direct"},H.info.screen())},screen:function(){return{$screen_height:screen.height,$screen_width:screen.width}},people_properties:function(){return H.strip_empty_properties({$os:H.info.os(),$browser:H.info.browser(m,k.vendor,window.opera)})},pageviewInfo:function(a){return H.strip_empty_properties({cn_page:a})}},H.inArray=function(a,b){if(a&&b&&b.length>0){for(var c=b.length-1;c>=0;c--)if(b[c]==a)return c;return-1}return-1},H.getDomain=function(a){var b=["gov.cn","org.cn","net.cn","com.cn"],c=a.split(".");if(c.length<3)return a;var d=c.slice(-2).join(".");return H.inArray(d,b)>-1?c.slice(-3).join("."):d};var L={log:function(){if(I&&!H.isUndefined(j)&&j)try{j.log.apply(j,arguments)}catch(a){H.each(arguments,function(a){j.log(a)})}},error:function(){if(I&&!H.isUndefined(j)&&j){var a=["alifenxi error:"].concat(H.toArray(arguments));try{j.error.apply(j,a)}catch(b){H.each(a,function(a){j.error(a)})}}},critical:function(){if(!H.isUndefined(j)&&j){var a=["alifenxi error:"].concat(H.toArray(arguments));try{j.error.apply(j,a)}catch(b){H.each(a,function(a){j.error(a)})}}}},M=function(){};M.prototype.create_properties=function(){},M.prototype.event_handler=function(){},M.prototype.after_track_handler=function(){},M.prototype.init=function(a){return this.cn=a,this},M.prototype.track=function(a,b,c,d,e){var f=this,g=null;return g="[object HTMLLIElement]"==h.call(a)?a:H.dom_query(a),0==g.length?void L.error("The DOM query ("+a+") returned 0 elements"):(c&&H.isFunction(c)&&(e=d,d=c),H.each(g,function(a){H.register_event(a,this.override_event,function(g){d&&d(a,c);var h={},i=f.create_properties(c,this),j=f.cn.get_config("track_links_timeout");f.event_handler(g,this,h),window.setTimeout(f.track_callback(e,i,h,!0),j),f.cn.track(b,i,f.track_callback(e,i,h))})},this),!0)},M.prototype.track_callback=function(a,b,c,d){d=d||!1;var e=this;return function(){c.callback_fired||(c.callback_fired=!0,a&&a(d,b)===!1||e.after_track_handler(b,c,d))}},M.prototype.create_properties=function(a,b){var c;return c="function"==typeof a?a(b):H.extend({},a)};var N=function(){this.override_event="click"};H.inherit(N,M),N.prototype.create_properties=function(a,b){var c=N.superclass.create_properties.apply(this,arguments);return b.href&&(c.url=b.href),c},N.prototype.event_handler=function(a,b,c){c.new_tab=2===a.which||a.metaKey||"_blank"===b.target,c.href=b.href,c.new_tab||a.preventDefault()},N.prototype.after_track_handler=function(a,b,c){b.new_tab||setTimeout(function(){window.location=b.href},0)};var O=function(){this.override_event="submit"};H.inherit(O,M),O.prototype.event_handler=function(a,b,c){c.element=b,a.preventDefault()},O.prototype.after_track_handler=function(a,b,c){setTimeout(function(){b.element.submit()},0)};var P=function(a){this.props={},this.campaign_params_saved=!1,a.cookie_name?this.name="cn_"+a.cookie_name:this.name="cn_"+a.token+"_alifenxi",this.load(),this.update_config(a),this.upgrade(a),this.save()};P.prototype.properties=function(){var a={};return H.each(this.props,function(b,c){H.include(z,c)||(a[c]=b)}),a},P.prototype.load=function(){if(!this.disabled){var a=H.cookie.parse(this.name);a&&(this.props=H.extend({},a))}},P.prototype.upgrade=function(a){var b,c,d=a.upgrade;d&&(b="cn_super_properties","string"==typeof d&&(b=d),c=H.cookie.parse(b),H.cookie.remove(b),H.cookie.remove(b,!0),c&&(this.props=H.extend(this.props,c.all,c.events))),a.cookie_name||"alifenxi"===a.name||(b="cn_"+a.token+"_"+a.name,c=H.cookie.parse(b),c&&(H.cookie.remove(b),H.cookie.remove(b,!0),this.register_once(c)))},P.prototype.save=function(){this.disabled||(this._expire_notification_campaigns(),H.cookie.set(this.name,H.JSONEncode(this.props),this.expire_days,this.cross_subdomain,this.secure))},P.prototype.remove=function(){H.cookie.remove(this.name,!1),H.cookie.remove(this.name,!0)},P.prototype.clear=function(){this.remove(),this.props={}},P.prototype.register_once=function(a,b,c){return H.isObject(a)?("undefined"==typeof b&&(b="None"),this.expire_days="undefined"==typeof c?this.default_expiry:c,H.each(a,function(a,c){this.props[c]&&this.props[c]!==b||(this.props[c]=a)},this),this.save(),!0):!1},P.prototype.register=function(a,b){return H.isObject(a)?(this.expire_days="undefined"==typeof b?this.default_expiry:b,H.extend(this.props,a),this.save(),!0):!1},P.prototype.unregister=function(a){H.isArray(a)?(H.each(a,function(a){a in this.props&&delete this.props[a]},this),this.save()):a in this.props&&(delete this.props[a],this.save())},P.prototype._expire_notification_campaigns=function(){var a=this.props[y],b=I?6e4:36e5;if(a){for(var c in a)1*new Date-a[c]>b&&delete a[c];H.isEmptyObject(a)&&delete this.props[y]}},P.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register(H.info.campaignParams()),this.campaign_params_saved=!0)},P.prototype.update_search_keyword=function(a){this.register(H.info.searchInfo(a))},P.prototype.update_initial_info=function(a){var b=new Date;this.register_once({$initial_time:Math.floor(b.getTime()/1e3)+60*b.getTimezoneOffset(),$initial_referrer:a||"$direct",$initial_referring_domain:H.info.referringDomain(a)||"$direct"},""),this.update_recent_outside_referrer(a)},P.prototype.update_recent_outside_referrer=function(a){if(a){var b=this.same_domain_host,c=function(a){var c=!1;if(b&&b.length>0)for(var d=0,e=b.length;e>d;d++)b[d].indexOf(a)>-1&&(c=!0);return c},d=l.createElement("a");d.href=a;var e=d.hostname,f=H.getDomain(e);f==H.getDomain(l.location.hostname)||c(f)||this.register({$recent_outside_referrer:e})}else this.register({$recent_outside_referrer:"$direct"})},P.prototype.get_referrer_info=function(){return H.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})},P.prototype.safe_merge=function(a){return H.each(this.props,function(b,c){c in a||(a[c]=b)}),a},P.prototype.update_config=function(a){this.default_expiry=this.expire_days=a.cookie_expiration,this.same_domain_host=a.same_domain_host||[],this.set_disabled(a.disable_cookie),this.set_cross_subdomain(a.cross_subdomain_cookie),this.set_secure(a.secure_cookie)},P.prototype.set_disabled=function(a){this.disabled=a,this.disabled&&this.remove()},P.prototype.set_cross_subdomain=function(a){a!==this.cross_subdomain&&(this.cross_subdomain=a,this.remove(),this.save())},P.prototype.get_cross_subdomain=function(){return this.cross_subdomain},P.prototype.set_secure=function(a){a!==this.secure&&(this.secure=a?!0:!1,this.remove(),this.save())},P.prototype._add_to_people_queue=function(a,b){var c=this._get_queue_key(a),d=b[a],e=this._get_or_create_queue(s),f=this._get_or_create_queue(t),g=this._get_or_create_queue(u),h=this._get_or_create_queue(v,[]);c===o?(H.extend(e,d),this._pop_from_people_queue(u,d)):c===p?H.each(d,function(a,b){b in f||(f[b]=a)}):c===q?H.each(d,function(a,b){b in e?e[b]+=a:(b in g||(g[b]=0),g[b]+=a)},this):c===r&&h.push(d),L.log("ALIFENXI PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),L.log(b),this.save()},P.prototype._pop_from_people_queue=function(a,b){var c=this._get_queue(a);H.isUndefined(c)||(H.each(b,function(a,b){delete c[b]},this),this.save())},P.prototype._get_queue_key=function(a){return a===s?o:a===t?p:a===u?q:a===v?r:void L.error("Invalid queue:",a)},P.prototype._get_queue=function(a){return this.props[this._get_queue_key(a)]},P.prototype._get_or_create_queue=function(a,b){var c=this._get_queue_key(a),b=H.isUndefined(b)?{}:b;return this.props[c]||(this.props[c]=b)};var Q=function(){};Q.prototype.init=function(b,c,d){if("undefined"==typeof d)return void L.error("You must name your new library: init(token, config, name)");if(d===n)return void L.error("You must initialize the main alifenxi object right after you include the Alifenxi js snippet");var e=S(b,c,d);return a[d]=e,e._loaded(),e},Q.prototype._init=function(a,b,c){this.__loaded=!0,this.config={},this.set_config(H.extend({},J,b,{name:c,token:a,callback_fn:(c===n?c:n+"."+c)+"._jsc"})),this._jsc=function(){},this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.cookie=new P(this.config),this.register_once({distinct_id:H.UUID()},"")},Q.prototype._loaded=function(){function a(){b._heartbeat(),D=setTimeout(a,1e3*b.get_config("heartbeat_interval"))}var b=this;this.get_config("loaded")(this),this.get_config("track_pageview")&&this.track_pageview(),this.get_config("heartbeat")&&a()},Q.prototype._heartbeat=function(){var a=this,b=H.cookie.get("cn_heartbeat_time_"+a.get_config("token")),c=H.cookie.get("cn_heartbeat_notneed_"+a.get_config("token")),d="",e="",f=Math.floor((new Date).getTime()/1e3);return c?void(D&&clearTimeout(D)):void(b?(b=b.split("|"),e=b[0]-0,d=b[1]-0,f-d>=this.get_config("heartbeat_interval")&&f<e+24*this.get_config("heartbeat_last_day")*60*60?(this._set_heartbeat_cookie(e+"|"+f),this._send_heartbeat()):D&&clearTimeout(D)):(this._set_heartbeat_cookie(f+"|"+f),this._send_heartbeat()))},Q.prototype._set_heartbeat_cookie=function(a){var b=this;H.cookie.set("cn_heartbeat_time_"+b.get_config("token"),a,b.get_config("cookie_expiration"),b.get_config("cross_subdomain_cookie"),b.get_config("secure_cookie"))},Q.prototype._send_heartbeat=function(a){var b=this;window.cnzz_callback=function(a){a&&-100==a.status&&H.cookie.set("cn_heartbeat_notneed_"+b.get_config("token"),!0,this.get_config("cookie_expiration"),this.get_config("cross_subdomain_cookie"),this.get_config("secure_cookie"))};var c=this.get_config("heartbeat_host")+"?token="+this.get_config("token")+"&t="+(new Date).getTime().toString()+"&callback=cnzz_callback",d=l.createElement("script");d.type="text/javascript",d.async=!0,d.defer=!0,d.src=c;var e=l.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e)},Q.prototype._dom_loaded=function(){H.each(this.__dom_loaded_queue,function(a){this._track_dom.apply(this,a)},this),H.each(this.__request_queue,function(a){this._send_request.apply(this,a)},this),delete this.__dom_loaded_queue,delete this.__request_queue},Q.prototype._track_dom=function(a,b){if(this.get_config("img"))return L.error("You can't use DOM tracking functions with img = true."),!1;if(!K)return this.__dom_loaded_queue.push([a,b]),!1;var c=(new a).init(this);return c.track.apply(c,b)},Q.prototype._prepare_callback=function(a,b){if(H.isUndefined(a))return null;if(F){var c=function(c){a(c,b)};return c}var d=this._jsc,e=""+Math.floor(1e8*Math.random()),f=this.get_config("callback_fn")+'["'+e+'"]';return d[e]=function(c){delete d[e],a(c,b)},f},Q.prototype._send_request=function(a,b,c){if(G)return void this.__request_queue.push(arguments);var d=this.get_config("verbose"),e=a;b.verbose&&(d=!0),this.get_config("test")&&(b.test=1),d&&(b.verbose=1),this.get_config("img")&&(b.img=1),F||(c?b.callback=c:(d||this.get_config("test"))&&(b.callback="(function(){})")),b.ip=this.get_config("ip")?1:0,b._=(new Date).getTime().toString();var f=H.HTTPBuildQuery(b),g=f.length;if(a+="?"+f,use_post="Internet Explorer"==H.info.browser(m,k.vendor,window.opera)?g>1900:g>4e3,"img"in b){var h=l.createElement("img");h.src=a,l.body.appendChild(h)}else if(F){var i=new XMLHttpRequest;use_post?(i.open("POST",e,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8")):i.open("GET",a,!0),i.withCredentials=!0,i.onreadystatechange=function(a){if(4===i.readyState)if(200===i.status)c&&c(d?H.JSONDecode(i.responseText):Number(i.responseText));else{var b="Bad HTTP status: "+i.status+" "+i.statusText;L.error(b),c&&c(d?{status:0,error:b}:0)}},i.send(use_post?f:null)}else{var j=l.createElement("script");j.type="text/javascript",j.async=!0,j.defer=!0,j.src=a;var n=l.getElementsByTagName("script")[0];n.parentNode.insertBefore(j,n)}},Q.prototype._execute_array=function(a){var b,c=[],d=[],e=[];H.each(a,function(a){a&&(b=a[0],"function"==typeof a?a.call(this):H.isArray(a)&&"alias"===b?c.push(a):H.isArray(a)&&-1!=b.indexOf("track")&&"function"==typeof this[b]?e.push(a):d.push(a))},this);var f=function(a,b){H.each(a,function(a){this[a[0]].apply(this,a.slice(1))},b)};f(c,this),f(d,this),f(e,this)},Q.prototype.push=function(a){this._execute_array([a])},Q.prototype.disable=function(a){"undefined"==typeof a?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(a)},Q.prototype.track_pageview=function(a){"undefined"==typeof a&&(a=l.location.href),this.track("cn_page_view",H.info.screen())},Q.prototype.track_links=function(){return this._track_dom.call(this,N,arguments)},Q.prototype.track_forms=function(){return this._track_dom.call(this,O,arguments)},Q.prototype.register=function(a,b){this.cookie.register(a,b)},Q.prototype.register_once=function(a,b,c){this.cookie.register_once(a,b,c)},Q.prototype.unregister=function(a){this.cookie.unregister(a)},Q.prototype.clear=function(){this.cookie.clear(),this.register_once({distinct_id:H.UUID()},"")},Q.prototype._register_single=function(a,b){var c={};c[a]=b,this.register(c)},Q.prototype.identify=function(a,b,c,d,e){a!=this.get_distinct_id()&&a!=this.get_property(x)&&(this.unregister(x),this._register_single("distinct_id",a)),this._flags.identify_called=!0,this.people._flush(b,c,d,e)},Q.prototype.get_distinct_id=function(){return this.get_property("distinct_id")},Q.prototype.name_tag=function(a){this._register_single("cn_name_tag",a)},Q.prototype.track=function(a,b,c){if("undefined"==typeof a)return void L.error("No event name provided to alifenxi.track");if(H.isBlockedUA(m)||this._flags.disable_all_events||H.include(this.__disabled_events,a))return void("undefined"!=typeof c&&c(0));var d=null,e=this._get_session_id(Math.floor((new Date).getTime()/1e3));if(H.isArray(a)){var f=a.length,d=[],g=this.get_config("token"),h=this.get_config("web_lang"),i=H.info.properties(),j=this.cookie.properties();b&&H.isArray(b)||(b=b||{});for(var k=0;f>k;k++){var n=b[k]||{};n.token=n.token||g,n.web_lang=h,n.$session_id=e,n=H.extend({},i,j,n),d.push({event:a[k],properties:n})}}else b=b||{},b.token=b.token||this.get_config("token"),b.web_lang=this.get_config("web_lang"),b.$session_id=e,this.get_config("store_google")&&this.cookie.update_campaign_params(),this.get_config("save_initial")&&this.cookie.update_initial_info(l.referrer),b=H.extend({},H.info.properties(),this.cookie.properties(),b),d={event:a,properties:b};var o=H.truncate(d,255),p=H.JSONEncode(o),q=H.base64Encode(p);return L.log("ALIFENXI REQUEST:"),L.log(o),this._send_request(this.get_config("api_host")+"/track/",{data:q},this._prepare_callback(c,o)),o},Q.prototype.set_config=function(a){H.isObject(a)&&(H.extend(this.config,a),this.cookie&&this.cookie.update_config(this.config),I=I||this.get_config("debug"))},Q.prototype.get_config=function(a){return this.config[a]},Q.prototype.get_property=function(a){return this.cookie.props[a]},Q.prototype.toString=function(){var a=this.get_config("name");return a!==n&&(a=n+"."+a),a},Q.prototype._get_session_id=function(a){var b=this,c=H.cookie.get("cn_session_id_"+b.get_config("token"));return c?a-c>=b.get_config("session_timeout")?(H.cookie.set("cn_session_id_"+b.get_config("token"),a,b.get_config("cookie_expiration"),b.get_config("cross_subdomain_cookie"),b.get_config("secure_cookie")),a):c:(H.cookie.set("cn_session_id_"+b.get_config("token"),a,b.get_config("cookie_expiration"),b.get_config("cross_subdomain_cookie"),b.get_config("secure_cookie")),a)};var R=function(){};R.prototype._init=function(a){this._alifenxi=a,this.custom_properties=null},R.prototype.get=function(){return this.custom_properties},R.prototype.set=function(a,b,c){var d={},e={};return H.isObject(a)?(H.each(a,function(a,b){"$distinct_id"!=b&&"$token"!=b&&(e[b]=a)}),c=b):e[a]=b,this.custom_properties=e,this._get_config("save_initial")&&this._alifenxi.cookie.update_initial_info(l.referrer),e=H.extend({},e),d[s]=e,this._send_request(d,c)},R.prototype.set_once=function(a,b,c){var d={},e={};return H.isObject(a)?(H.each(a,function(a,b){"$distinct_id"!=b&&"$token"!=b&&(e[b]=a)}),c=b):e[a]=b,d[t]=e,this._send_request(d,c)},R.prototype.increment=function(a,b,c){var d={},e={};return H.isObject(a)?(H.each(a,function(a,b){return"$distinct_id"!=b&&"$token"!=b?isNaN(parseFloat(a))?void L.error("Invalid increment value passed to alifenxi.people.increment - must be a number"):void(e[b]=a):void 0}),c=b):(H.isUndefined(b)&&(b=1),e[a]=b),d[u]=e,this._send_request(d,c)},R.prototype.append=function(a,b,c){var d={},e={};return H.isObject(a)?(H.each(a,function(a,b){"$distinct_id"!=b&&"$token"!=b&&(e[b]=a)}),c=b):e[a]=b,d[v]=e,this._send_request(d,c)},R.prototype.track_charge=function(a,b,c){return!H.isNumber(a)&&(a=parseFloat(a),isNaN(a))?void L.error("Invalid value passed to alifenxi.people.track_charge - must be a number"):this.append("$transactions",H.extend({$amount:a},b),c)},R.prototype.clear_charges=function(a){return this.set("$transactions",[],a)},R.prototype.delete_user=function(){if(!this._identify_called())return void L.error("alifenxi.people.delete_user() requires you to call identify() first");var a={$delete:this._alifenxi.get_distinct_id()};return this._send_request(a)},R.prototype.toString=function(){return this._alifenxi.toString()+".people"},R.prototype._send_request=function(a,b){a.$token=this._get_config("token"),a.$distinct_id=this._alifenxi.get_distinct_id();var c=H.encodeDates(a),d=H.truncate(c,255),e=H.JSONEncode(c),f=H.base64Encode(e);return this._identify_called()?(L.log("ALIFENXI PEOPLE REQUEST:"),L.log(d),this._alifenxi._send_request(this._get_config("api_host")+"/engage/",{data:f},this._alifenxi._prepare_callback(b,d)),d):(this._enqueue(a),H.isUndefined(b)||b(this._get_config("verbose")?{status:-1,error:null}:-1),d)},R.prototype._get_config=function(a){return this._alifenxi.get_config(a)},R.prototype._identify_called=function(){return this._alifenxi._flags.identify_called===!0},R.prototype._enqueue=function(a){s in a?this._alifenxi.cookie._add_to_people_queue(s,a):t in a?this._alifenxi.cookie._add_to_people_queue(t,a):u in a?this._alifenxi.cookie._add_to_people_queue(u,a):v in a?this._alifenxi.cookie._add_to_people_queue(v,a):L.error("Invalid call to _enqueue():",a)},R.prototype._flush=function(a,b,c,d){var e=this,f=H.extend({},this._alifenxi.cookie._get_queue(s)),g=H.extend({},this._alifenxi.cookie._get_queue(t)),h=H.extend({},this._alifenxi.cookie._get_queue(u)),i=this._alifenxi.cookie._get_queue(v);
if(H.isUndefined(f)||!H.isObject(f)||H.isEmptyObject(f)||(e._alifenxi.cookie._pop_from_people_queue(s,f),this.set(f,function(b,c){0==b&&e._alifenxi.cookie._add_to_people_queue(s,f),H.isUndefined(a)||a(b,c)})),H.isUndefined(g)||!H.isObject(g)||H.isEmptyObject(g)||(e._alifenxi.cookie._pop_from_people_queue(t,g),this.set_once(g,function(a,b){0==a&&e._alifenxi.cookie._add_to_people_queue(t,g),H.isUndefined(d)||d(a,b)})),H.isUndefined(h)||!H.isObject(h)||H.isEmptyObject(h)||(e._alifenxi.cookie._pop_from_people_queue(u,h),this.increment(h,function(a,c){0==a&&e._alifenxi.cookie._add_to_people_queue(u,h),H.isUndefined(b)||b(a,c)})),!H.isUndefined(i)&&H.isArray(i)&&i.length){for(var j=i.length-1;j>=0;j--){var k=i.pop();e.append(k,function(a,b){0==a&&e._alifenxi.cookie._add_to_people_queue(v,k),H.isUndefined(c)||c(a,b)})}e._alifenxi.cookie.save()}},H.toArray=H.toArray,H.isObject=H.isObject,H.JSONEncode=H.JSONEncode,H.JSONDecode=H.JSONDecode,H.isBlockedUA=H.isBlockedUA,H.isEmptyObject=H.isEmptyObject,H.info=H.info,H.info.device=H.info.device,H.info.browser=H.info.browser,Q.prototype.init=Q.prototype.init,Q.prototype.disable=Q.prototype.disable,Q.prototype.track=Q.prototype.track,Q.prototype.track_links=Q.prototype.track_links,Q.prototype.track_forms=Q.prototype.track_forms,Q.prototype.track_pageview=Q.prototype.track_pageview,Q.prototype.register=Q.prototype.register,Q.prototype.register_once=Q.prototype.register_once,Q.prototype.unregister=Q.prototype.unregister,Q.prototype.clear=Q.prototype.clear,Q.prototype.identify=Q.prototype.identify,Q.prototype.set_config=Q.prototype.set_config,Q.prototype.get_config=Q.prototype.get_config,Q.prototype.get_property=Q.prototype.get_property,Q.prototype.get_distinct_id=Q.prototype.get_distinct_id,Q.prototype.toString=Q.prototype.toString,P.prototype.properties=P.prototype.properties,P.prototype.update_search_keyword=P.prototype.update_search_keyword,P.prototype.update_initial_info=P.prototype.update_initial_info,P.prototype.get_cross_subdomain=P.prototype.get_cross_subdomain,P.prototype.clear=P.prototype.clear,H.safewrap_class(P,["_expire_notification_campaigns"]),H.safewrap_class(Q,["identify","_show_notification"]);var S=function(b,c,d){var e,f=d===n?a:a[d];return f&&!H.isArray(f)?void L.error("You have already initialized "+d):(e=new Q,e._init(b,c,d),e.people=new R,e.people._init(e),I=I||e.get_config("debug"),H.isUndefined(f)||(e._execute_array.call(e.people,f.people),e._execute_array(f)),e)};if(H.isUndefined(a))return void L.critical("'alifenxi' object not initialized. Ensure you are using the latest version of the Alifenxi JS Library along with the snippet we provide.");if(a.__loaded||a.config&&a.cookie)return void L.error("Alifenxi library has already been downloaded at least once.");if(1.1>E)return void L.critical("Version mismatch; please ensure you're using the latest version of the Alifenxi code snippet.");var T={};H.each(a._i,function(a){var b,c;a&&H.isArray(a)&&(b=a[a.length-1],c=S.apply(this,a),T[b]=c)});var U=function(){H.each(T,function(b,c){c!==n&&(a[c]=b)}),a._=H};if(a.init=function(b,c,d){if(d)a[d]||(a[d]=T[d]=create_mplib(b,c,d),a[d]._loaded());else{var e=a;T[n]?e=T[n]:b&&(e=create_mplib(b,c,n),e._loaded()),window[n]=a=e,U()}},a.init(),H.each(T,function(a){a._loaded()}),l.addEventListener)"complete"==l.readyState?b():l.addEventListener("DOMContentLoaded",b,!1);else if(l.attachEvent){l.attachEvent("onreadystatechange",b);var V=!1;try{V=null==window.frameElement}catch(W){}l.documentElement.doScroll&&V&&c()}H.register_event(window,"load",b,!0)}(window.alifenxi);